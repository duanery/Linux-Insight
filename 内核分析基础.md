# 内核分析基础

> [![40](https://github.com/duanery/picture/blob/master/github/github_black_40px.png)](https://duanery.github.io)
> &nbsp;&nbsp;
> ***duanery*** &nbsp;
> 2019年7月20日
>
> Linux爱好者

描述内核分析的基础认知。

## 一、编译相关

### 编译内核源码由Kbuild定义的宏

#### 编译.c文件
- \_\_KERNEL__: 内核编译，内核头文件可以用于用户态的应用程序来include，也可以用于内核源码，内核源码在编译时会指定该宏。
- KBUILD_BASENAME: basename，编译源码文件去掉后缀，且-替换为_得到的名字
- KBUILD_MODNAME: 模块名字，一般等于basename

#### 编译.s文件
- \_\_KERNEL\_\_: 内核编译，汇编文件也会包含内核头文件，也需要区分是内核include，还是用户态include。
- \_\___ASSEMBLY\_\_: 指定正在编译汇编代码。内核头文件中，可能会区分在汇编模式下某些宏的定义，跟非汇编模式下该宏的定义不一致。

### 编译模块由Kbuild定义的宏
#### 编译.c文件
- \_\_KERNEL\_\_:
- KBUILD_BASENAME:
- KBUILD_MODNAME:
- MODULE: 编译模块

#### 编译.s文件
- \_\_KERNEL\_\_: 
- \_\___ASSEMBLY\_\_:
- MODULE: 编译模块

## 二、基本意识
1. 数据结构是内嵌式的还是直接式的。
2. 数据结构是全局的，还是percpu的。
